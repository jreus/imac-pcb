Version 4
SHEET 1 1172 712
WIRE 176 -224 144 -224
WIRE 256 -224 240 -224
WIRE 32 -208 32 -240
WIRE -144 -128 -144 -192
WIRE 144 -128 144 -224
WIRE 144 -128 32 -128
WIRE 160 -128 144 -128
WIRE 256 -128 256 -224
WIRE 256 -128 240 -128
WIRE 624 -128 624 -176
WIRE 112 -80 112 -176
WIRE 32 -64 32 -128
WIRE 80 -64 32 -64
WIRE -720 -48 -800 -48
WIRE -560 -48 -640 -48
WIRE 256 -48 256 -128
WIRE 256 -48 144 -48
WIRE 304 -48 256 -48
WIRE -384 -32 -416 -32
WIRE -144 -32 -144 -64
WIRE -144 -32 -240 -32
WIRE 0 -32 -144 -32
WIRE 80 -32 0 -32
WIRE 0 0 0 -32
WIRE 0 96 0 80
WIRE 112 128 112 -16
WIRE -720 160 -800 160
WIRE -560 160 -640 160
WIRE 576 192 576 80
WIRE 704 192 704 80
WIRE 0 208 0 176
WIRE 576 304 576 272
WIRE 704 304 704 272
WIRE 704 304 576 304
WIRE 576 336 576 304
WIRE -720 368 -784 368
WIRE -592 368 -640 368
WIRE -256 368 -320 368
WIRE -128 368 -176 368
FLAG 0 208 Vref
FLAG 112 128 0
FLAG 112 -176 V+
FLAG -416 -32 LINE
FLAG -784 368 0
FLAG -528 368 PIEZO_KNOCK
FLAG 576 80 V+
FLAG 704 80 Vref
FLAG 576 336 0
FLAG 32 -240 Vref
FLAG -800 160 0
FLAG -560 160 COIL
FLAG 544 -176 MOD_INPUT
FLAG 304 -48 MOD_INPUT
FLAG -800 -48 0
FLAG -560 -48 LINE
FLAG 768 -176 Vref
FLAG 624 -48 0
FLAG -320 368 0
FLAG -64 368 PIEZO_BEND
FLAG -144 -192 V+
SYMBOL Opamps/LT1677 112 -112 R0
SYMATTR InstName U1
SYMBOL cap -240 -48 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 1µ
SYMBOL res -16 -16 R0
SYMATTR InstName R1
SYMATTR Value {Rin}
SYMBOL voltage -624 368 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
WINDOW 39 54 56 VTop 2
WINDOW 123 76 56 VTop 2
SYMATTR InstName V1
SYMATTR Value SINE(0 2 500 0 500 0 0)
SYMATTR SpiceLine Rser=1000
SYMATTR Value2 AC 2
SYMBOL voltage 576 176 R0
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL res 48 -112 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R5
SYMATTR Value 1k
SYMBOL res 256 -144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 3.3k
SYMBOL voltage 704 176 R0
SYMATTR InstName V3
SYMATTR Value 2.5
SYMBOL cap 240 -240 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 220p
SYMBOL voltage -624 160 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
WINDOW 39 54 56 VTop 2
WINDOW 123 76 56 VTop 2
SYMATTR InstName V4
SYMATTR Value SINE(0 0.2 500 0 0 0 0)
SYMATTR SpiceLine Rser=300
SYMATTR Value2 AC 0.2
SYMBOL res -16 80 R0
SYMATTR InstName R2
SYMATTR Value {Rz}
SYMBOL voltage -624 -48 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
WINDOW 39 54 56 VTop 2
WINDOW 123 76 56 VTop 2
SYMATTR InstName V5
SYMATTR Value SINE(0 1.0 3000 0 0 0 0)
SYMATTR SpiceLine Rser=600
SYMATTR Value2 AC 1.2
SYMBOL cap 688 -192 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 1µ
SYMBOL res 784 -192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 1meg
SYMBOL res 608 -144 R0
SYMATTR InstName R4
SYMATTR Value 25k
SYMBOL res 640 -192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 25k
SYMBOL cap -528 352 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 20n
SYMBOL voltage -160 368 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
WINDOW 39 54 56 VTop 2
WINDOW 123 76 56 VTop 2
SYMATTR InstName V6
SYMATTR Value SINE(0 50 3000 0 500 0 0)
SYMATTR SpiceLine Rser=1000
SYMATTR Value2 AC 50
SYMBOL cap -64 352 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C5
SYMATTR Value 20n
SYMBOL diode -128 -64 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL res -288 -48 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 33k
TEXT -1040 -344 Left 2 ;PIEZO PRE-AMP
TEXT 272 40 Right 2 ;<- Adjustable INPUT Z
TEXT -1032 -240 Left 2 !#.PARAM Rin=100k\n.PARAM Rz=100\n.STEP PARAM Rin list 1 1k 10k 25k 50k 75k 100k\n#.TRAN 0.01 0.01\n.AC DEC 100 1 500000
TEXT 72 152 Left 2 ;<- Make this resistor easily replacible..\nhave some backup values eg. 1meg
TEXT -880 504 Left 2 ;A piezo disk has around 15nF series capacitance  (depending on size)\nA lightly attached piezo will generate around 2V p2p from a strong knock. But will easily generate 50V or more if given a strong bend.
TEXT -864 72 Left 2 ;LINE IN 1.2 V p2p with 600 ohm Z
TEXT -440 24 Left 2 ;33k resistor limits \ncurrent spikes\nwithin the threshhold of \nthe op-amp (MCP6004)
TEXT -864 264 Left 2 ;Pickup coils are about 300ohms, light signals are around \n200mV p2p. Transformer coils generate around 2v p2p close up.
TEXT -856 -352 Left 2 ;This is a very tricky circuit. Trying to negotiate a balance between\nthe high-Z piezo and lower impedance inputs.\nThe high-Z piezo has a large capacitance in its output\nand so creates nasty hi-pass filters.
TEXT 152 -320 Left 2 ;this cap just stabilizes the op-amp and filters out\n>200khz frequencies, probably not totally necessary.
TEXT -360 -224 Left 2 ;diode protects against\npiezo high voltages\nthere is an internal diode up\nfrom GND inside the MCP6004
